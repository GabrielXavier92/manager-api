# Migration `20200711155313-init`

This migration has been generated by Gabriel Xavier at 7/11/2020, 3:53:13 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Schedule" (
"accountId" text  NOT NULL ,
"comments" text   ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"doctorId" text  NOT NULL ,
"id" text  NOT NULL ,
"patientId" text  NOT NULL ,
"time" text  NOT NULL ,
"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_ProcedureToSchedule" (
"A" text  NOT NULL ,
"B" text  NOT NULL )

CREATE UNIQUE INDEX "_ProcedureToSchedule_AB_unique" ON "public"."_ProcedureToSchedule"("A","B")

CREATE  INDEX "_ProcedureToSchedule_B_index" ON "public"."_ProcedureToSchedule"("B")

ALTER TABLE "public"."Schedule" ADD FOREIGN KEY ("accountId")REFERENCES "public"."Account"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Schedule" ADD FOREIGN KEY ("doctorId")REFERENCES "public"."Doctor"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Schedule" ADD FOREIGN KEY ("patientId")REFERENCES "public"."Patient"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_ProcedureToSchedule" ADD FOREIGN KEY ("A")REFERENCES "public"."Procedure"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_ProcedureToSchedule" ADD FOREIGN KEY ("B")REFERENCES "public"."Schedule"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200711155313-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,153 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+enum Plan {
+  STARTER
+}
+
+model Account {
+  id String          @id @default(uuid())
+  plan Plan @default(STARTER)
+  status Boolean  @default(true)
+  name String
+  users User[]
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+enum Gender {
+  MASCULINO
+  FEMININO
+}
+
+model User {
+  id String          @id @default(uuid())
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta
+  status Boolean @default(true)
+  email String @unique
+  password String
+  name String
+  gender Gender? // Enum
+  roles Roles[] @relation(references: [id])  // Relacionamento com as roles
+  doctor Doctor?  @relation(fields: [doctorId], references: [id]) // Relacionamento com um Doctor caso exista
+  doctorId String? // Relacionamento com um Doctor caso exista
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Roles {
+  id String @id @default(uuid())
+  role String @unique
+  users User[] @relation(references: [id])
+}
+
+model Doctor {
+  id String          @id @default(uuid())
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta
+  user User? // Relacionamento com um User caso exista
+  name String
+  gender Gender? // Enum
+  birth String?
+  register String?
+  email String?
+  country String?
+  cep String?
+  state String?
+  city String?
+  street String?
+  neighborhood String?
+  complement String?
+  guides Guide[] // Relacionamento com as guias
+  specialties Specialty[]  @relation(references: [id]) // Relacionamento com as especialidades
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Patient {
+  id String          @id @default(uuid())
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta
+  name String
+  gender Gender? // Enum
+  birth String?
+  guides Guide[] // Relacionamento com as guias
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Guide {
+  id String          @id @default(uuid())
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta
+  doctor Doctor @relation(fields: [doctorId], references: [id]) // Relacionamento com um Doctor
+  doctorId String // Relacionamento com um Doctor
+  patient Patient @relation(fields: [patientId], references: [id]) // Relacionamento com um Patient
+  patientId String // Relacionamento com um Patient
+  description String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Specialty {
+  id String     @id @default(uuid())
+  name String
+  doctor Doctor[] @relation(references: [id]) // relacionamento com os dentistas
+  procedures Procedure[] // relacionamento com os procedimentos
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta 
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model ProcedureTable {
+  id String          @id @default(uuid())
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta  
+  name String
+  procedures Procedure[] // Relacionamento com os procedimentos
+  isDefault Boolean @default(false)
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Procedure {
+  id String       @id  @default(uuid())
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta
+  name String
+  code String?
+  value String?
+  procedureTable ProcedureTable @relation(fields: [procedureTableId], references: [id]) // Relacionamento com uma tabela
+  procedureTableId String  // Relacionamento com uma tabela
+  specialty Specialty @relation(fields: [specialtyId], references: [id]) // Relacionamento com uma especialidade
+  specialtyId String // Relacionamento com uma especialidade
+  schedules Schedule[] @relation(references: [id])
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Schedule {
+  id String       @id  @default(uuid())
+  account Account @relation(fields: [accountId], references: [id]) // Relacionamento com a conta
+  accountId String // Relacionamento com a conta
+  doctor Doctor @relation(fields: [doctorId], references: [id]) // Relacionamento com um Doctor
+  doctorId String // Relacionamento com um Doctor
+  patient Patient @relation(fields: [patientId], references: [id]) // Relacionamento com um Patient
+  patientId String // Relacionamento com um Patient
+  procedures Procedure[] @relation(references: [id])
+  time String
+  comments String?
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
```


